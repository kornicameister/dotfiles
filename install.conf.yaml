---
- defaults:
    link:
      create: true
      relink: true

- clean: ["~"]
- create:
    ~/.ssh:
      mode: 0700
    ~/.ssh/config.d:
    ~/.local:
      mode: 0700
    ~/.local/share/fonts:
    ~/.local/bin:
    ~/.cache:
    ~/.config:
      mode: 750

- shell:
    - - git submodule sync --recursive
      - Installing submodules
    - - git submodule update
        --recursive
        --init
        --checkout
        --no-recommend-shallow
        --force
        --jobs 4
        --progress
      - Checkouting submodules

# main repo goes first, you know gotta be careful here
- link:
    ~/.dotfiles: ""

- link:
    # amazon q
    ~/.aws/amazonq/agents: aws/amazonq/agents
    ~/.aws/amazonq/prompts: aws/amazonq/prompts

    # ssh config
    ~/.ssh/config: ssh/config
    ~/.ssh/config.d/00-defaults.config: ssh/config.d/00-defaults.config
    ~/.ssh/config.d/01-github.config: ssh/config.d/01-github.config
    ~/.ssh/config.d/02-aws-ec2-ssm.config: ssh/config.d/02-aws-ec2-ssm.config

    # git stuff
    ~/.gitignore: gitignore
    ~/.gitattributes: gitattributes
    ~/.gitconfig:
      path: gitconfig
      if: |
        [[ ${CI:-False} ]] && exit 0 || exit 1
    ~/.git_template: git_template

    # fzf
    ~/.fzf.settings: fzf.settings

    # node
    ~/.npmrc.sh: npmrc.sh

    # python
    ~/.pdbrc: .pdbrc

    # gpg-agent
    ~/.gnupg/gpg-agent.conf: gpg-agent.conf

    # custom application/tools configuration
    ~/.config:
      glob: true
      force: true
      path: config/*

    # custom binaries
    ~/.local/bin:
      glob: true
      path: bin/*

    # mycli configuration
    ~/.myclirc: myclirc
